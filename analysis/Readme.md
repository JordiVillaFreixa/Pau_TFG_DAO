# Analysis of the MD results

## Getting the results from external computers

A script `rsync_output.sh` is provided to `rsync` the results obtained in external computers, in case they have not been generated locally.

## Plotting data

Run `RMS.ipynb` to generate plots of the evolution of the MD run. The notebook also saves a collection of csv files to be processed further in the `./data` folder. The script makes use of two tools, within respective python functions:
* [`MDAnalysis`](https://www.mdanalysis.org/): to analyze the trajectory files generated by Amber
* [`process_mdout.perl`](https://structbio.vanderbilt.edu/archives/amber-archive/2005/att-2572/01-process_mdout.perl): to extract the summaries of the different metrics obtained through the simulation, from the `.mdout` files.

Run `merge_plots.ipynb` to generate publication quality images. It makes use of the dataframes generated in the `./data` folder, so you need to run first `RMS.ipynb`.

## Visualizing trajectories

The trajectories can be visually inspected using [vmd](https://www.ks.uiuc.edu/Research/vmd/). In order to visualize them, first we need to transform the `.nc` files into `.dcd` Charmm trajectories. This is done with [`cpptraj`](https://amberhub.chpc.utah.edu/cpptraj/running-cpptraj/) or its python interface [`pytraj`](https://computecanada.github.io/molmodsim-pytraj-analysis/04-NGLView/index.html). A jupyter notebook `visualize_trajectories.ipynb` is provided to help in the analysis. To use it, install first `pytraj` by:
``` 
git clone https://github.com/Amber-MD/pytraj
cd pytraj

python ./setup.py install
``` 

Note: you may need to [ensure `$PYTHONPATH` is unset](https://github.com/Amber-MD/pytraj/issues/1565) by typing:
``` 
unset $PYTHONPATH
``` 
prior to run the jupyter notebook. See [this example](https://ambermd.org/tutorials/analysis/tutorial_notebooks/nglview_notebook/index.html) on how to play together with `pytraj` and `NGLView`.

https://ambermd.org/tutorials/analysis/tutorial_notebooks/pytraj_notebook/index.php
https://colab.research.google.com/github/pablo-arantes/making-it-rain/blob/main/Amber_inputs.ipynb#scrollTo=p2Y0DgwTxLWc